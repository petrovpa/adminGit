webpackJsonp([2],{"/Ahx":function(e,t,n){(e.exports=n("lcwS")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"role-manage-rights.component.scss",sourceRoot:""}])},"3HvT":function(e,t){e.exports='<form #f="ngForm"\n      [ngClass]="{\'was-validated\': wasValidated}"\n      class="page-form-edit role-manage-edit-form" novalidate autocomplete="off"\n      (submit)="submit(f)">\n\n  \x3c!-- Форма --\x3e\n  <div class="row">\n    <div class="col-sm-6 col-12">\n      <form-control-label title="Системное имя" [required]="true">\n        <input-field name="roleSysName"\n                     [(ngModel)]="role.ROLESYSNAME"\n                     [required]="true"\n                     [filter]="filterSysName"\n                     [disabled]="isEdit || isFormDisabled"></input-field>\n      </form-control-label>\n    </div>\n    <div class="col-sm-6 col-12">\n      <form-control-label title="Наименование" [required]="true">\n        <input-field name="roleName"\n                     [(ngModel)]="role.ROLENAME"\n                     [required]="true"\n                     [disabled]="isFormDisabled"></input-field>\n      </form-control-label>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-12">\n      <form-control-label title="Описание" [required]="true">\n        <text-area name="description"\n                   [(ngModel)]="role.DESCRIPTION"\n                   [required]="true"\n                   [autoSize]="true"\n                   [disabled]="isFormDisabled"></text-area>\n      </form-control-label>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-sm-6 col-12">\n      <form-control-label title="Дата с">\n        <input-datepicker name="roleDateStart"\n                          [(ngModel)]="role.ROLEDATESTART"\n                          [maxDate]="role.ROLEDATEEND"\n                          [disabled]="isFormDisabled"></input-datepicker>\n      </form-control-label>\n    </div>\n    <div class="col-sm-6 col-12">\n      <form-control-label title="Дата по">\n        <input-datepicker name="roleDateEnd"\n                          [(ngModel)]="role.ROLEDATEEND"\n                          [minDate]="role.ROLEDATESTART"\n                          [disabled]="isFormDisabled"></input-datepicker>\n      </form-control-label>\n    </div>\n  </div>\n\n  \x3c!-- Кнопки --\x3e\n  <div class="page__btn">\n    <div class="row">\n      <div class="col-sm-6 col-12">\n\n      </div>\n      <div class="col-sm-6 col-12">\n        <button type="submit"\n                class="btn btn-primary btn-rounded btn-block"\n                [disabled]="isServiceInProgress || isFormDisabled">\n          Сохранить\n        </button>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-sm-6 col-12">\n        <button type="button"\n                class="btn btn-link btn-rounded btn-block"\n                [disabled]="isServiceInProgress"\n                (click)="cancel(f)">Отмена\n        </button>\n      </div>\n      <div class="col-sm-6 col-12">\n        <button type="submit"\n                class="btn btn-primary btn-rounded btn-block"\n                [disabled]="isServiceInProgress || !role.ROLEID"\n                (click)="next(f)">Продолжить\n        </button>\n      </div>\n    </div>\n  </div>\n\n  <debug-form name="form" [form]="f"></debug-form>\n</form>\n'},"4Xo9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("FhS4"),a=n("+laO"),l=n("NWuu"),s=n("7/oP"),u=function(){function e(e,t,n,o){this.session=e,this.routingState=t,this.roleManage=n,this.document=o}return e.prototype.canActivate=function(e,t){return!!this.session.getContext("roleId")||(this.roleManage.isNewRecord||this.routingState.navigate(l.ROUTE_ROLE_MANAGE_LIST),this.document.body.style.cursor="auto",!1)},o.__decorate([r.Injectable(),o.__param(3,r.Inject(i.DOCUMENT)),o.__metadata("design:paramtypes",[a.SessionService,a.RoutingStateService,s.RoleManageService,Object])],e)}();t.RoleManageEditGuard=u},"5jMU":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("tk1w"),a=n("uz/q"),l=n("DuaU"),s=n("PKVp"),u=n("NWuu"),c=n("7/oP"),d=n("s3Ab"),g=function(e){function t(t,n){var o=e.call(this,t)||this;return o.injector=t,o.roleManage=n,o.role=new d.Role,o.isEdit=!1,o.filterSysName=/([^A-Za-z0-9])/,o}return o.__extends(t,e),t.prototype.ngOnInit=function(){var e=this.session.getContext("roleId");e?(this.isEdit=!0,this.role&&this.role.ROLEID===e?this.routingState.navigate(u.ROUTE_ROLE_MANAGE_LIST):this.loadRole(e)):(this.role=new d.Role,this.roleManage.role=this.role,this.roleManage.isNewRecord=!0)},t.prototype.loadRole=function(e){var t=this;this.roleManage.roleLoad(e).subscribe(function(e){e.Error?t.isFormDisabled=!0:t.role=e})},t.prototype.submitPage=function(e,t){var n=this;this.roleManage.roleSave(this.role).finally(function(){n.isServiceInProgress=!1}).subscribe(function(e){e.Error?n.dialogService.alert(a.ModalType.Error,l.MESSAGE_ERROR_SAVE):(n.role.ROLEID=e.ROLEID,n.isEdit=!0,n.session.context={roleId:e.ROLEID},s.isFunction(t)&&t())})},o.__decorate([r.Component({selector:"app-role-manage-edit",template:n("3HvT"),styles:[n("vUiW")]}),o.__metadata("design:paramtypes",[r.Injector,c.RoleManageService])],t)}(i.BaseFormComponent);t.RoleManageEditComponent=g},"7/oP":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("+laO"),a=n("s3Ab"),l=function(){function e(e){this.rest=e,this.isNewRecord=!1}return e.prototype.roleLoad=function(e){var t=this;return this.rest.doCall("admrestgate/loadRoleById",{ROLEID:e}).map(function(e){return e.Error?e:(t.role=new a.Role(e),t.role)})},e.prototype.roleSave=function(e){return this.rest.doCall("admrestgate/saveRole",e)},e.prototype.roleRemove=function(e){return this.rest.doCall("admrestgate/deleteRoleById",{ROLEID:e})},e.prototype.rightRemove=function(e,t){return this.rest.doCall("rights/removeObjectRights",{OBJECTID:e,RIGHTID:t,RIGHTOWNER:"ROLE"})},o.__decorate([r.Injectable(),o.__metadata("design:paramtypes",[i.RestService])],e)}();t.RoleManageService=l},FGqh:function(e,t,n){var o=n("kG1l");e.exports="string"==typeof o?o:o.toString()},Fp5Z:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("FhS4"),a=n("kVLv"),l=n("jWmD"),s=n("kLaQ"),u=n("UjCx"),c=n("sYcf"),d=n("uz/q"),g=n("ZxrY"),p=n("Xpk6"),R=n("u2LD"),E=n("5jMU"),m=n("YYMW"),f=n("4Xo9"),v=n("7/oP"),_=n("uklR"),O=function(){return o.__decorate([r.NgModule({imports:[i.CommonModule,p.RoleManageRoutingModule,l.FormControlModule,s.FormControlLabelModule,a.JournalModule,c.CustomButtonGroupModule,u.DatatableModule,d.ModalDialogModule,g.DebugModule,_.ManageRightModule],declarations:[R.RoleManageComponent,E.RoleManageEditComponent,m.RoleManageRightsComponent],providers:[f.RoleManageEditGuard,v.RoleManageService]})],function(){})}();t.RoleManageModule=O},O7oe:function(e,t){e.exports='<div class="page-form-edit">\n  <journal class="journal"\n           #journal\n           sysName="ADMINRIGHTSMANAGE"\n           [customParams]="{OBJECTID: roleId, RIGHTOWNER: \'ROLE\'}"\n           [journalServicePath]="\'journal/\'"\n           [journalButtons]="journalButtons"\n           [journalButtonsAction]="journalButtonsAction"\n           (onDoubleClicked)="viewRight(journal.selected)"></journal>\n\n  \x3c!-- Кнопки --\x3e\n  <div class="row" *ngIf="!journal.isInit">\n    <div class="col-sm-6 col-12">\n      <button type="button"\n              class="btn btn-link btn-rounded btn-block"\n              [disabled]="isServiceInProgress"\n              (click)="navigateBack()">Вернуться\n      </button>\n    </div>\n    <div class="col-sm-6 col-12">\n    </div>\n  </div>\n</div>\n'},XnXL:function(e,t){e.exports='<journal class="journal"\n         #journal\n         sysName="ADMINROLESMANAGE"\n         (onDoubleClicked)="viewRole(journal.selected)"\n         [journalServicePath]="\'journal/\'"\n         [journalButtons]="journalButtons"\n         [journalButtonsAction]="journalButtonsAction"></journal>\n'},Xpk6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("UllE"),a=n("NWuu"),l=n("u2LD"),s=n("5jMU"),u=n("YYMW"),c=n("4Xo9"),d=n("rHMe"),g=[{path:"",component:l.RoleManageComponent,data:{title:"Роли"}},{path:"main",component:s.RoleManageEditComponent,data:{title:"Роли. Общая информация",next:a.ROUTE_ROLE_MANAGE_RIGHTS,cancel:a.ROUTE_ROLE_MANAGE_LIST,menuClose:["role-manage"]}},{path:"rights",component:u.RoleManageRightsComponent,data:{title:"Роли. Права",back:a.ROUTE_ROLE_MANAGE_MAIN,menuClose:["role-manage"]},canActivate:[c.RoleManageEditGuard]},{path:"rights/simple",component:d.ManageRightSimpleComponent,data:{title:"Роли. Права. Простое право",menuTitle:"Роли. Права",menu:[{title:"Простое право",path:a.ROUTE_ROLE_MANAGE_RIGHTS_SIMPLE}],cancel:a.ROUTE_ROLE_MANAGE_RIGHTS,menuClose:["role-manage","rights"]},canActivate:[c.RoleManageEditGuard]},{path:"rights/profile",component:d.ManageRightProfileComponent,data:{title:"Роли. Права. Профильное право",menuTitle:"Роли. Права",menu:[{title:"Профильное право",path:a.ROUTE_ROLE_MANAGE_RIGHTS_PROFILE}],cancel:a.ROUTE_ROLE_MANAGE_RIGHTS,menuClose:["role-manage","rights"]},canActivate:[c.RoleManageEditGuard]}],p=function(){return o.__decorate([r.NgModule({imports:[i.RouterModule.forChild(g)],exports:[i.RouterModule]})],function(){})}();t.RoleManageRoutingModule=p},YYMW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("uz/q"),a=n("NWuu"),l=n("kVLv"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.injector=t,n.journalButtons=[{title:"Добавить простое право",styleClass:"custom-button__add",iconClass:"icon-add",sysName:"add"},{title:"Добавить профильное право",styleClass:"custom-button__add-right-profile",iconClass:"icon-plus-bold",sysName:"add_right"},l.JOURNAL_BUTTON_REMOVE],n.journalButtonsAction={add:function(){var e=n.session.getContext("roleId");n.routingState.navigate(a.ROUTE_ROLE_MANAGE_RIGHTS_SIMPLE,{roleId:e,rightObjectId:e,rightOwner:"ROLE"})},add_right:function(){var e=n.session.getContext("roleId");n.routingState.navigate(a.ROUTE_ROLE_MANAGE_RIGHTS_PROFILE,{roleId:e,rightObjectId:e,rightOwner:"ROLE"})},remove:function(e){var t=e[0];n.dialogService.confirm(i.ModalType.Warning,"Вы действительно хотите удалить выбранное право у роли?").subscribe(function(){n.rightRemove(t.RIGHTID)},function(e){})}},n}return o.__extends(t,e),t.prototype.initPage=function(){this.roleId=this.session.getContext("roleId")},t.prototype.rightRemove=function(e){var t=this;this.roleManage.rightRemove(this.role.ROLEID,e).subscribe(function(e){t.journal.getData()})},t.prototype.viewRight=function(e){this.routingState.navigate(1==e.RIGHTTYPE?a.ROUTE_ROLE_MANAGE_RIGHTS_SIMPLE:a.ROUTE_ROLE_MANAGE_RIGHTS_PROFILE,{roleId:this.role.ROLEID,rightObjectId:this.role.ROLEID,rightOwner:"ROLE",rightId:e.RIGHTID,rightName:e.RIGHTNAME,rightSysName:e.RIGHTSYSNAME})},o.__decorate([r.ViewChild("journal"),o.__metadata("design:type",Object)],t.prototype,"journal",void 0),o.__decorate([r.Component({selector:"app-role-manage-rights",template:n("O7oe"),styles:[n("akk3")]}),o.__metadata("design:paramtypes",[r.Injector])],t)}(n("rET/").RoleManageBaseComponent);t.RoleManageRightsComponent=s},akk3:function(e,t,n){var o=n("/Ahx");e.exports="string"==typeof o?o:o.toString()},kG1l:function(e,t,n){(e.exports=n("lcwS")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"role-manage.component.scss",sourceRoot:""}])},"rET/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("tk1w"),i=n("7/oP"),a=n("s3Ab"),l=n("NWuu"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.injector=t,n.role=new a.Role,n.roleManage=n.injector.get(i.RoleManageService),n}return o.__extends(t,e),t.prototype.ngOnInit=function(){var e=this.session.getContext("roleId"),t=this.roleManage.role;e?t&&t.ROLEID?t.ROLEID===parseInt(e)?this.role=t:this.routingState.navigate(l.ROUTE_ROLE_MANAGE_LIST):this.loadRole(e):this.routingState.navigate(l.ROUTE_ROLE_MANAGE_LIST),this.initPage()},t.prototype.loadRole=function(e){var t=this;this.roleManage.roleLoad(e).subscribe(function(e){t.role=e})},t.prototype.initPage=function(){this.logger.warn("need override page")},t}(r.BaseFormComponent);t.RoleManageBaseComponent=s},s3Ab:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.assign(n,t),n}return o.__extends(t,e),Object.defineProperty(t.prototype,"DESCRIPTION",{get:function(){return this._DESCRIPTION},set:function(e){this._DESCRIPTION=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PROJECTID",{get:function(){return this._PROJECTID},set:function(e){this._PROJECTID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLEID",{get:function(){return this._ROLEID},set:function(e){this._ROLEID=+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLENAME",{get:function(){return this._ROLENAME},set:function(e){this._ROLENAME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLESYSNAME",{get:function(){return this._ROLESYSNAME},set:function(e){this._ROLESYSNAME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLEVIEWNAME",{get:function(){return this._ROLEVIEWNAME},set:function(e){this._ROLEVIEWNAME=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLEDATESTART",{get:function(){return this._ROLEDATESTART},set:function(e){this._ROLEDATESTART=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ROLEDATEEND",{get:function(){return this._ROLEDATEEND},set:function(e){this._ROLEDATEEND=e},enumerable:!0,configurable:!0}),t}(n("+laO").Mappable);t.Role=r},sCQo:function(e,t,n){(e.exports=n("lcwS")(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"role-manage-edit.component.scss",sourceRoot:""}])},u2LD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("vCxL"),r=n("LBxa"),i=n("8E6H"),a=n("+laO"),l=n("uz/q"),s=n("7/oP"),u=n("NWuu"),c=n("kVLv"),d=function(){function e(e,t,n,o){var r=this;this.routingState=e,this.dialogService=t,this.roleManageService=n,this.logger=o,this.journalButtons=[c.JOURNAL_BUTTON_ADD,c.JOURNAL_BUTTON_REMOVE],this.journalButtonsAction={add:function(){r.routingState.navigate(u.ROUTE_ROLE_MANAGE_MAIN)},remove:function(e){var t=e[0];r.dialogService.confirm(l.ModalType.Warning,"Вы действительно хотите удалить выбранную роль?").subscribe(function(){r.roleRemove(t)},function(e){})}}}return e.prototype.ngOnInit=function(){},e.prototype.viewRole=function(e){this.routingState.navigate(u.ROUTE_ROLE_MANAGE_MAIN,{roleId:e.ROLEID})},e.prototype.roleRemove=function(e){var t=this;this.roleManageService.roleRemove(e.ROLEID).subscribe(function(e){t.journal.getData()})},o.__decorate([r.ViewChild("journal"),o.__metadata("design:type",Object)],e.prototype,"journal",void 0),o.__decorate([r.Component({selector:"app-role-manage",template:n("XnXL"),styles:[n("FGqh")]}),o.__metadata("design:paramtypes",[a.RoutingStateService,l.ModalDialogService,s.RoleManageService,i.Logger])],e)}();t.RoleManageComponent=d},vUiW:function(e,t,n){var o=n("sCQo");e.exports="string"==typeof o?o:o.toString()}});